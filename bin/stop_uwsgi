#!/bin/bash

#
# uWSGI shutdown script for: csc-api-server
#

NAME="ten-server"

BASEDIR=$(dirname $0)

# Get absolute basedirectory
APPDIR=`python -c "import os; print(os.path.abspath('$BASEDIR/../backend'));"`
cd $APPDIR

# Helper: Get value from config file.
function config_get {
  python -c "from ten.settings import SERVER; print SERVER['$1']"
}

#### BEGIN CONFIGURATION ####
# Warning: Do not edit this file.
# PID_FILE=$APPDIR/csc-api-server.pid
PID_FILE=$(config_get pidfile)
#### END CONFIGURATION ####

if [ ! -r $PID_FILE ]; then
  echo "Error: $NAME is not running."
  exit -1
fi

PID=$(cat $PID_FILE)

# Kill server
kill -INT $PID

